<!-- eslint-disable @angular-eslint/template/cyclomatic-complexity -->
<div class="list-item newrow">
    <p>
        Welcome to PECS, a largely automated character tool for Pathfinder RPG 2nd Edition. This tool is meant to allow
        you to build your character according to the rules and options in PFRPG 2e and then use that character in play.
    </p>
</div>

<ng-container *ngIf="updateAvailable$ | async as updateAvailable">
    <div
        *ngIf="updateAvailable.available"
        class="list-item newrow center-aligned"
    >
        <a
            *ngIf="updateAvailable.desc !== 'n/a'"
            href='https://github.com/bukiro/PECS/releases/latest'
            target="_blank"
            rel="noreferrer noopener"
        >
            {{updateAvailable.desc}}
        </a>

        <span *ngIf="updateAvailable.desc === 'n/a'">{{updateAvailable.desc}}</span>
    </div>
</ng-container>

<div
    *ngIf="version"
    class="newrow list-item left-aligned lower"
>
    <header class="spellHeader">
        New in version
        <select
            aria-label="Select version"
            [(ngModel)]="version"
        >
            <option
                *ngFor="let versionChange of changelog; trackBy:trackByIndex;"
                [ngValue]="versionChange.version"
            >
                {{versionChange.version}}
            </option>
        </select>
    </header>

    <div
        *ngFor="let change of (selectedVersionLog$ | async)?.changes; trackBy:trackByIndex;"
        class="newrow list-item left-aligned"
    >
        <header
            *ngIf="change.header"
            class="subsectionHeader"
        >
            {{change.header}}
        </header>

        <app-description
            *ngFor="let split of change.desc.split('\n\n'); trackBy:trackByIndex"
            [text]="split"
        />

        <div
            *ngFor="let image of change.images; trackBy:trackByIndex"
            class="newrow list-item center-aligned"
        >
            <img
                style="max-width:100%; flex-grow: 0;"
                title="{{change.header}}"
                src="assets/img/about/{{image.file}}"
            >
            <span
                *ngIf="image.title"
                class="newrow center-aligned"
            >
                {{image.title}}
            </span>
        </div>
    </div>
</div>

<ng-container *ngFor="let paragraph of welcome; trackBy: trackByIndex;">
    <div class="list-item newrow">
        <div class="newrow left-aligned">
            <header
                *ngIf="paragraph.header"
                class="spellHeader"
            >
                {{paragraph.header}}
            </header>

            <app-description
                *ngFor="let split of paragraph.desc.split('\n\n'); trackBy:trackByIndex"
                [text]="split"
            />
        </div>
    </div>
</ng-container>

<div class="list-item newrow">
    <header class="spellHeader">Hints and Tips</header>

    <ng-container *ngFor="let hint of hints; trackBy:trackByIndex;">
        <div class="newrow list-item left-aligned">
            <header
                *ngIf="hint.header"
                class="subsectionHeader"
            >
                {{hint.header}}
            </header>

            <app-description
                *ngFor="let split of hint.desc.split('\n\n'); trackBy:trackByIndex"
                [text]="split"
            />

            <div
                *ngFor="let image of hint.images; trackBy:trackByIndex"
                class="newrow list-item center-aligned"
            >
                <img
                    style="max-width:100%; flex-grow: 0;"
                    title="{{hint.header}}"
                    src="assets/img/about/{{image.file}}"
                >
                <span
                    *ngIf="image.title"
                    class="newrow center-aligned"
                >
                    {{image.title}}
                </span>
            </div>
        </div>
    </ng-container>
</div>
