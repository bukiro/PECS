<!-- eslint-disable @angular-eslint/template/cyclomatic-complexity -->
<div class="character-sheet-card filter-buttons">
    <app-button
        class="filter-buttons__button"
        [toggled]="shownMode === 'All'"
        (clicked)="toggleShownMode('All')"
    >
        Show All
    </app-button>

    <app-button
        class="filter-buttons__button"
        [toggled]="shownMode === 'Encounter'"
        (click)="toggleShownMode('Encounter')"
    >
        Encounter
    </app-button>

    <app-button
        class="filter-buttons__button"
        [toggled]="shownMode === 'Exploration'"
        (click)="toggleShownMode('Exploration')"
    >
        Exploration
    </app-button>

    <app-button
        class="filter-buttons__button"
        [toggled]="shownMode === 'Downtime'"
        (click)="toggleShownMode('Downtime')"
    >
        Downtime
    </app-button>

    <app-button
        class="filter-buttons__button"
        [toggled]="shownMode === 'Inventory'"
        (click)="toggleShownMode('Inventory')"
    >
        Inventory
    </app-button>

    <app-button
        class="filter-buttons__button"
        [toggled]="shownMode === 'ConditionsEffects'"
        (click)="toggleShownMode('ConditionsEffects')"
    >
        Conditions & Effects
    </app-button>
</div>

<ng-container *ngIf="shownMode !== 'ConditionsEffects'; else ConditionsAndEffectsTemplate">
    <app-effects />

    <div class="character-sheet-columns">
        <div
            *ngFor="let column of [0, 1]; trackBy: trackByIndex;"
            class="character-sheet-columns__column"
        >

            <app-general *ngIf="showInColumn[column][shownMode]?.includes('general_upper')" />

            <app-defense *ngIf="showInColumn[column][shownMode]?.includes('defense')" />

            <ng-container *ngFor="let order of [0, 1]; trackBy:trackByIndex;">
                <app-attacks *ngIf="showInColumn[column][shownMode]?.includes('attacks') && attacksAndSpellsOrder['attacks'] === order" />

                <app-spellbook *ngIf="showInColumn[column][shownMode]?.includes('spellbook_upper') && attacksAndSpellsOrder['spells'] === order" />
            </ng-container>

            <app-health
                *ngIf="showInColumn[column][shownMode]?.includes('health')"
                [forceMinimized]="shownMode === 'Downtime'"
            />

            <app-general *ngIf="showInColumn[column][shownMode]?.includes('general_lower')" />

            <app-abilities *ngIf="showInColumn[column][shownMode]?.includes('abilities')" />

            <app-skills *ngIf="showInColumn[column][shownMode]?.includes('skills')" />

            <app-activities *ngIf="showInColumn[column][shownMode]?.includes('activities')" />

            <app-spellbook *ngIf="showInColumn[column][shownMode]?.includes('spellbook_lower')" />

            <app-inventory *ngIf="showInColumn[column][shownMode]?.includes('inventory')" />
        </div>
    </div>
</ng-container>

<ng-template #ConditionsAndEffectsTemplate>
    <app-effects [fullDisplay]="true" />
</ng-template>
