<!-- eslint-disable @angular-eslint/template/cyclomatic-complexity -->
<ng-template
    #Split
    let-toSplit="toSplit"
>
    <ng-container *ngFor="let split of toSplit.split('|'); trackBy:trackByIndex;">
        <app-quickdice
            *ngIf="split.includes('dice=')"
            [diceString]="split.replace('dice=','')"
            [casting]="casting"
        />

        <span
            *ngIf="!split.includes('dice=') && split.includes('<')"
            [innerHtml]="split.trim()"
        ></span>

        <span *ngIf="!split.includes('dice=') && !split.includes('<')">{{split.trim()}}</span>
    </ng-container>
</ng-template>

<ng-container *ngIf="oneLiner && text">
    <ng-container *ngTemplateOutlet="Split;context:{toSplit:text}" />
</ng-container>

<ng-container *ngIf="!oneLiner && text">
    <p *ngIf="text.split('\n').length === 1">
        <ng-container *ngTemplateOutlet="Split;context:{toSplit:text}" />
    </p>

    <ul *ngIf="text.split('\n').length > 1">
        <li *ngFor="let line of text.split('\n'); trackBy:trackByIndex;">
            <ng-container *ngTemplateOutlet="Split;context:{toSplit:line}" />
        </li>
    </ul>
</ng-container>
