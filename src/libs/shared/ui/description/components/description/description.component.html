<!-- eslint-disable @angular-eslint/template/cyclomatic-complexity -->
<ng-template
    #Split
    let-toSplit="toSplit"
>
    @for (split of toSplit.split("|"); track $index) {
        @if (split.includes("dice=")) {
            <app-quickdice
                [diceString]="split.replace('dice=', '')"
                [casting]="casting"
            />
        }

        @if (!split.includes("dice=") && split.includes("<")) {
            <span [innerHtml]="split.trim()"></span>
        }

        @if (!split.includes("dice=") && !split.includes("<")) {
            <span>{{ split.trim() }}</span>
        }
    }
</ng-template>

@if (oneLiner && text) {
    <ng-container *ngTemplateOutlet="Split; context: { toSplit: text }" />
}

@if (!oneLiner && text) {
    @if (text.split("\n").length === 1) {
        <p>
            <ng-container
                *ngTemplateOutlet="Split; context: { toSplit: text }"
            />
        </p>
    }

    @if (text.split("\n").length > 1) {
        <ul>
            @for (line of text.split("\n"); track $index) {
                <li>
                    <ng-container
                        *ngTemplateOutlet="Split; context: { toSplit: line }"
                    />
                </li>
            }
        </ul>
    }
}
