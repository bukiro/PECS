@if (showOptions$$()) {
    <div
        tabindex="0"
        class="click-outside-overlay"
        (click)="toggleOptions()"
        (keydown.escape)="toggleOptions(false)"
        (keydown.shift.tab)="focusCenterButton($event)"
        (keydown.tab)="focusFirstButton($event)"
    ></div>
}

@if (options) {
    @for (option of options; track $index) {
        <div
            class="option option--of-{{ options.length }} option--index-{{
                $index
            }} option--left-{{ option.left }}"
            [ngClass]="{ 'option--active': showOptions$$() }"
            [style.top]="option.top + 'px'"
            [style.left]="option.left + 'px'"
            [style.transform]="showOptions$$() ? option.transform : 'none'"
        >
            <div
                #optionButtonContainer
                class="option__inner-button"
                [ngbTooltip]="option.disabled"
            >
                <app-button
                    #optionButton
                    [tabIndex]="showOptions$$() ? 0 : -1"
                    [toggled]="option.toggled"
                    [circle]="option.circle"
                    [disabled]="option.disabled"
                    (clicked)="
                        option.onClick();
                        option.closeAfter ? toggleOptions() : null
                    "
                    (keydown.escape)="toggleOptions(false); focusCenterButton($event)"
                    (keydown.shift.tab)="
                        $first ? focusCenterButton($event) : undefined
                    "
                >
                    @if (option.label) {
                        <span>{{ option.label }}</span>
                    }
                    @if (option.icon) {
                        <i [ngClass]="option.icon"></i>
                    }
                </app-button>
            </div>
        </div>
    }
}

<div
    #centerButtonContainer
    class="button-container"
>
    <app-button
        #centerButton
        class="button button--center"
        [label]="label"
        [hideLabel]="showOptions$$() || shouldHideLabel"
        [circle]="isCircle"
        [compact]="isCompact"
        [disabled]="isDisabled"
        [toggled]="isToggled"
        [processing]="isProcessing"
        [noOutline]="isNotOutlined"
        [ghost]="isGhost"
        (clicked)="toggleOptions()"
        (keydown.escape)="toggleOptions(false); focusCenterButton($event)"
        (keydown.tab)="
            showOptions$$() ? focusFirstButton($event) : undefined
        "
    >
        <ng-content />
    </app-button>
</div>
