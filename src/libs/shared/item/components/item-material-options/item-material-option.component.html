<!-- Changing Material -->
@if (materialOptionApplies) {
    <div class="list-item">
        <div class="newrow">
            <strong>Material</strong>

            <select
                aria-label="Select material"
                [(ngModel)]="newMaterial[0]"
                (ngModelChange)="onSelectMaterial()"
            >
                @for (
                    material of initialMaterials();
                    track $index
                ) {
                    @if ($first) {
                        <option
                            [ngValue]="material"
                            [selected]="!item.material[0]"
                        >
                            <!-- Blank option to deselect -->
                        </option>
                    } @else {
                        <optgroup label="Current material">
                            <option [ngValue]="material">
                                {{ material.material.name }}
                            </option>
                        </optgroup>
                    }
                }

                @if (availableMaterials$() | async; as availableMaterials) {
                    @if (availableMaterials.length) {
                        <optgroup label="Available materials">
                            @for (
                                material of availableMaterials;
                                track $index
                            ) {
                                <option
                                    [ngValue]="material"
                                    [disabled]="material.disabled"
                                    title="{{
                                        materialTitle(material.material)
                                    }}"
                                >
                                    {{ material.material.name }}
                                </option>
                            }
                        </optgroup>
                    }
                }
            </select>
        </div>

        @if (craftingStation) {
            @for (material of item.material; track $index) {
                @if (material.craftRequirement) {
                    <div class="newrow">
                        <span>
                            <strong>Craft Requirement&nbsp;</strong>

                            <span>{{ material.craftRequirement }}</span>
                        </span>
                    </div>
                }
            }
        }
    </div>
}
