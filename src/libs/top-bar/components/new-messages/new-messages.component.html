<ng-container *ngIf="checkMessagesAutomatically; else ManualCheckTemplate">
    <app-button
        *ngIf="messages$ | async as messages"
        class="messages-button"
        compact
        [label]="messages.length > 1 ? 'Select messages to apply' : 'No messages available'"
        [disabled]="!messages.length"
        (clicked)="showMessagesDialog(messages)"
    >
        <ng-container [ngTemplateOutlet]="IconTemplate" />

        <div
            *ngIf="messages.length"
            class="messages-button__badge"
        >
            {{messages.length}}
        </div>
    </app-button>
</ng-container>

<ng-template #ManualCheckTemplate>
    <app-button
        *ngIf="{ set: hasPartyName } as partyName"
        class="messages-button"
        compact
        [label]="partyName.set ? 'Check for new messages' : 'You can only receive messages in a party.'"
        [disabled]="!partyName.set || (checkingMessages$ | async) || false"
        (clicked)="checkMessages()"
    >
        <app-loading-spinner *ngIf="checkingMessages$ | async; else IconTemplate" />
    </app-button>
</ng-template>

<ng-template #IconTemplate>
    <i class="ra ra-player-thunder-struck messages-button__content"></i>
</ng-template>
