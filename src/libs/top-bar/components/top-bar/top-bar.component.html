<!-- eslint-disable @angular-eslint/template/cyclomatic-complexity -->
<app-logo
    class="logo"
    ngbTooltip="Pathfinder Excessive Character Sheet"
></app-logo>

<app-button
    class="top-bar-button"
    label="Edit character and settings"
    [toggled]="(sideMenuState$ | async) === menuNames.CharacterCreationMenu"
    (clicked)="toggleLeftMenu(menuNames.CharacterCreationMenu)"
    showLabel
    compact
>
    <div class=top-bar-button__content>
        <i class="ra ra-player"></i>

        <i class="bi-gear"></i>
    </div>
</app-button>

<app-button
    *ngIf="isCompanionAvailable$ | async"
    label="Show animal companion"
    class="top-bar-button"
    [toggled]="(sideMenuState$ | async) === menuNames.CompanionMenu"
    (clicked)="toggleLeftMenu(menuNames.CompanionMenu)"
    showLabel
    compact
>
    <i class="ra ra-wolf-howl top-bar-button__content"></i>
</app-button>

<app-button
    *ngIf="isFamiliarAvailable$ | async"
    label="Show familiar"
    class="top-bar-button"
    [toggled]="(sideMenuState$ | async) === menuNames.FamiliarMenu"
    (clicked)="toggleLeftMenu(menuNames.FamiliarMenu)"
    showLabel
>
    <i class="ra ra-raven top-bar-button__content"></i>
</app-button>

<app-button
    class="top-bar-button"
    [toggled]="(sideMenuState$ | async) === menuNames.ItemsMenu"
    (clicked)="toggleLeftMenu(menuNames.ItemsMenu)"
    compact
>
    <span class="top-bar-button__content">Items</span>
</app-button>

<app-button
    class="top-bar-button"
    [toggled]="(sideMenuState$ | async) === menuNames.CraftingMenu"
    (clicked)="toggleLeftMenu(menuNames.CraftingMenu)"
    compact
>
    <span class="top-bar-button__content">Crafting</span>
</app-button>

<app-button
    *ngIf="hasAnySpells$ | async"
    class="top-bar-button"
    [toggled]="(sideMenuState$ | async) === menuNames.SpellSelectionMenu"
    (clicked)="toggleLeftMenu(menuNames.SpellSelectionMenu)"
    compact
>
    <span class="top-bar-button__content">Spellbook</span>
</app-button>

<app-button
    class="top-bar-button"
    [toggled]="(sideMenuState$ | async) === menuNames.SpellLibraryMenu"
    (clicked)="toggleLeftMenu(menuNames.SpellLibraryMenu)"
    compact
>
    <span class="top-bar-button__content">Spell Library</span>
</app-button>

<app-button
    class="top-bar-button"
    [toggled]="(sideMenuState$ | async) === menuNames.ConditionsMenu"
    (clicked)="toggleLeftMenu(menuNames.ConditionsMenu)"
    compact
>
    <span class="top-bar-button__content">Conditions</span>
</app-button>

<app-button
    class="top-bar-button"
    label="Dice"
    [toggled]="(topMenuState$ | async) === menuNames.DiceMenu"
    (clicked)="toggleTopMenu(menuNames.DiceMenu)"
    compact
>
    <app-dice-icon-D20 class="top-bar-button__content top-bar-button__content--dice"></app-dice-icon-D20>
</app-button>

<!-- Save and Effects buttons change depending on some factors -->
<ng-container *ngIf="apiButtonsStatus$ | async as apiButtonsStatus">
    <app-button
        *ngIf="apiButtonsStatus.isGmMode; else ButtonsTemplate"
        class="top-bar-button"
        label="In GM mode, the character can\'t be saved and can\'t send effects to other players."
        showLabel
        disabled
        compact
    >
        <span class="top-bar-button__content">GM Mode</span>
    </app-button>

    <ng-template #ButtonsTemplate>

        <app-button
            *ngIf="apiButtonsStatus.isBlankCharacter; else FinalButtonsTemplate"
            class="top-bar-button"
            label="No changes to character yet"
            showLabel
            disabled
            compact
        >
            <i class="bi-file-earmark-arrow-up top-bar-button__content"></i>
        </app-button>

        <ng-template #FinalButtonsTemplate>
            <app-button
                class="top-bar-button"
                label="Save Character"
                (clicked)="save()"
                showLabel
                compact
            >
                <i class="bi-file-earmark-arrow-up top-bar-button__content"></i>
            </app-button>

            <app-new-messages
                *ngIf="apiButtonsStatus.showMessagesButton"
                class="top-bar-button"
                [hasPartyName]="apiButtonsStatus.hasPartyName"
                [checkMessagesAutomatically]="apiButtonsStatus.checkMessagesAutomatically"
                [applyMessagesAutomatically]="apiButtonsStatus.applyMessagesAutomatically"
            ></app-new-messages>
        </ng-template>
    </ng-template>
</ng-container>

<app-button
    class="top-bar-button"
    label="Refresh all"
    (clicked)="refreshAll()"
    showLabel
    compact
>
    <i class="ra ra-cycle top-bar-button__content"></i>
</app-button>
