<button class="minimizebutton lower" (click)="minimize()" *ngIf="creature=='Character'">&#8691;</button>
<div id="{{creature}}-effects-height" class="attributeBox">
    <h3 class="box-header">Active Conditions</h3>
    <ng-container *ngFor="let conditionGain of get_AppliedConditions(true); trackBy:trackByIndex;">
        <div class="list-item" *ngFor="let condition of [get_Conditions(conditionGain.name)[0]]; trackBy:trackByIndex;">
            <div class="row">
                <span>
                    <strong [className]="condition.buff ? 'bonus' : 'penalty'"
                        title="Source: {{conditionGain.source}}">{{conditionGain.name}}{{conditionGain.persistentDamage ? ": "+conditionGain.persistentDamage : ""}}
                        {{(conditionGain.value) ? conditionGain.value : ""}} 
                    </strong>
                </span>
            </div>
            <div class="row fullsize-only">
                <span>{{get_Duration(conditionGain.duration)}}</span>
            </div>
            <div class="row fullsize-only" *ngIf="conditionGain.duration != -1">
                <span><button (click)="change_ConditionDuration(conditionGain, -10)" [disabled]="conditionGain.duration <= 10">- 1 turn</button></span>
                <span><button (click)="change_ConditionDuration(conditionGain, 10)">+ 1 turn</button></span>
                <span><button (click)="change_ConditionDuration(conditionGain, 100)">+ 1 min.</button></span>
                <span><button (click)="change_ConditionDuration(conditionGain, 1000)">+ 10 min.</button></span>
            </div>
            <div class="row fullsize-only" *ngIf="conditionGain.value">
                <span><button (click)="change_ConditionValue(conditionGain, -1)">Value - 1</button></span>
                <span><button (click)="change_ConditionValue(conditionGain, 1)">Value + 1</button></span>
            </div>
            <div class="row fullsize-only">
                <div class="list-item lower row problem" *ngIf="condition.inputRequired">
                    <strong>Player input required:</strong>
                    <div class="row left-aligned">
                        <p *ngFor="let inputRequired of condition.inputRequired.split('\n'); trackBy:trackByIndex;">
                            {{inputRequired}}
                        </p>
                    </div>
                </div>
                <div class="row">
                    <span>
                        <button (click)="remove_Condition(conditionGain)">
                            Remove
                        </button>
                    </span>
                    <span>
                        <button
                            (click)="toggle_Item(conditionGain.name+conditionGain.source+conditionGain.value+conditionGain.duration+'applied')">
                            Show Description
                        </button>
                    </span>
                </div>
                <ng-container
                    *ngIf="this.get_ShowItem()==conditionGain.name+conditionGain.source+conditionGain.value+conditionGain.duration+'applied'">
                    <div class="row  lower left-aligned" *ngFor="let desc of condition.desc.split('\n\n'); trackBy:trackByIndex;">
                        <p *ngIf="desc.split('\n').length == 1" [innerHTML]="desc"></p>
                        <ul *ngIf="desc.split('\n').length > 1">
                            <li *ngFor="let line of desc.split('\n'); trackBy:trackByIndex;" [innerHTML]="line"></li>
                        </ul>
                    </div>
                </ng-container>
            </div>
        </div>
    </ng-container>
    <h3 class="box-header">Active Effects</h3>
    <div class="list-item row lower" *ngFor="let effect of get_AppliedEffects(); trackBy:trackByIndex;">
        <span>
            <strong [ngClass]="{'penalty':effect.penalty, 'bonus':!effect.penalty && !effect.setValue, 'absolute':effect.setValue}"
                title="Source: {{effect.source}}">{{effect.target}}
                {{parseInt(effect.value) ? effect.value : ''}}{{effect.setValue ? "= "+effect.setValue : ''}}
            </strong>
            {{(effect.type != "untyped") ? effect.type+' ' : ''}}{{(effect.toggle || effect.setValue) ? '' : (effect.penalty ? 'penalty' : 'bonus')}}
        </span>
    </div>
    <button class="list-item fullsize-only center-aligned"
        (click)="toggle_NotApplied()">{{(showNotApplied) ? "Hide not applied" : "Show not applied"}}</button>
    <div class="fullsize-only" *ngIf="showNotApplied">
        <h3 class="box-header">Not Applied Conditions</h3>
        <div class="list-item notapplied" *ngFor="let conditionGain of get_AppliedConditions(false); trackBy:trackByIndex;">
            <div class="row">
                <span>
                    <strong [className]="get_Conditions(conditionGain.name)[0]?.buff ? 'bonus' : 'penalty'"
                        title="Source: {{conditionGain.source}}">{{conditionGain.name}}
                        {{(conditionGain.value) ? conditionGain.value : ""}}
                    </strong>
                </span>
            </div>
            <div class="row fullsize-only">
                <span>{{get_Duration(conditionGain.duration)}}</span>
            </div>
            <ng-container *ngFor="let condition of [get_Conditions(conditionGain.name)[0]]; trackBy:trackByIndex;">
                <div class="row">
                    <span>
                        <button (click)="remove_Condition(conditionGain)">
                            Remove
                        </button>
                    </span>
                    <span>
                        <button
                            (click)="toggle_Item(conditionGain.name+conditionGain.source+conditionGain.value+conditionGain.duration+'notapplied')">
                            Show Description
                        </button>
                    </span>
                </div>
                <ng-container
                    *ngIf="this.get_ShowItem()==conditionGain.name+conditionGain.source+conditionGain.value+conditionGain.duration+'notapplied'">
                    <div class="row  lower left-aligned" *ngFor="let desc of condition.desc.split('\n\n'); trackBy:trackByIndex;">
                        <p *ngIf="desc.split('\n').length == 1" [innerHTML]="desc"></p>
                        <ul *ngIf="desc.split('\n').length > 1">
                            <li *ngFor="let line of desc.split('\n'); trackBy:trackByIndex;" [innerHTML]="line"></li>
                        </ul>
                    </div>
                </ng-container>
            </ng-container>
        </div>
        <h3 class="box-header">Not Applied Effects</h3>
        <div class="list-item row lower notapplied" *ngFor="let effect of get_NotAppliedEffects(); trackBy:trackByIndex;">
            <span>
                <strong [ngClass]="{'penalty':effect.penalty, 'bonus':!effect.penalty && !effect.setValue, 'absolute':effect.setValue}"
                    title="Source: {{effect.source}}">{{effect.target}}
                    {{parseInt(effect.value) ? effect.value : ''}}{{effect.setValue ? "= "+effect.setValue : ''}}
                </strong>
                {{(effect.type != "untyped") ? effect.type+' ' : ''}}{{(effect.toggle || effect.setValue) ? '' : (effect.penalty ? 'penalty' : 'bonus')}}
            </span>
        </div>
    </div>
    <button class="list-item fullsize-only center-aligned"
        (click)="toggle_Hidden()">{{(showHidden) ? "Hide hidden effects" : "Show hidden effects"}}</button>
    <div class="fullsize-only" *ngIf="showHidden">
        <h3 class="box-header">Hidden Effects</h3>
        <div class="list-item row lower" *ngFor="let effect of get_HiddenEffects(); trackBy:trackByIndex;">
            <span>
                <strong [ngClass]="{'penalty':effect.penalty, 'bonus':!effect.penalty && !effect.setValue, 'absolute':effect.setValue}"
                    title="Source: {{effect.source}}">{{effect.target}}
                    {{parseInt(effect.value) ? effect.value : ''}}{{effect.setValue ? "= "+effect.setValue : ''}}
                </strong>
                {{(effect.type != "untyped") ? effect.type+' ' : ''}}
            </span>
        </div>
    </div>
</div>
<div *ngIf="set_Span()"></div>